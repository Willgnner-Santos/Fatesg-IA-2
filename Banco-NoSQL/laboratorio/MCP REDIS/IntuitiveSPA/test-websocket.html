<!DOCTYPE html>
<html>
<head>
    <title>Teste WebSocket</title>
</head>
<body>
    <h1>Teste de Conex√£o WebSocket</h1>
    <div id="status">Iniciando...</div>
    <div id="logs"></div>
    
    <script>
        const statusDiv = document.getElementById('status');
        const logsDiv = document.getElementById('logs');
        
        function addLog(message) {
            console.log(message);
            logsDiv.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
        }
        
        addLog('üöÄ Iniciando teste de conex√£o...');
        
        try {
            addLog('üîó Criando WebSocket para ws://localhost:3000');
            const socket = new WebSocket('ws://localhost:3000');
            
            socket.onopen = function(event) {
                addLog('‚úÖ Conex√£o estabelecida com sucesso!');
                statusDiv.innerHTML = '<span style="color: green;">CONECTADO</span>';
                
                // Enviar mensagem de teste
                const testMessage = {
                    jsonrpc: '2.0',
                    id: 'test-1',
                    method: 'ping'
                };
                addLog('üì§ Enviando mensagem de teste: ' + JSON.stringify(testMessage));
                socket.send(JSON.stringify(testMessage));
            };
            
            socket.onmessage = function(event) {
                addLog('üì• Mensagem recebida: ' + event.data);
            };
            
            socket.onerror = function(error) {
                addLog('‚ùå Erro: ' + error.toString());
                statusDiv.innerHTML = '<span style="color: red;">ERRO</span>';
            };
            
            socket.onclose = function(event) {
                addLog('üîå Conex√£o fechada. C√≥digo: ' + event.code + ', Raz√£o: ' + event.reason);
                statusDiv.innerHTML = '<span style="color: orange;">DESCONECTADO</span>';
            };
            
        } catch (error) {
            addLog('üí• Exce√ß√£o: ' + error.toString());
            statusDiv.innerHTML = '<span style="color: red;">ERRO CR√çTICO</span>';
        }
    </script>
</body>
</html>